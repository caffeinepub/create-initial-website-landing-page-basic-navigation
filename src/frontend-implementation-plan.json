{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix frontend build/deploy wiring for end-to-end DFX deployment",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Align frontend build artifacts and documentation with a root-level DFX project that serves the Vite build from frontend/dist",
      "acceptanceCriteria": [
        "A new `dfx.json` exists at the repo root.",
        "`dfx start --clean` followed by `dfx deploy` completes successfully on local replica.",
        "`dfx canister call backend getSiteInfo` returns the expected fields (name, tagline, heroCta).",
        "After local deploy, visiting the local frontend canister URL loads the React app and the homepage displays the backend-provided site info (e.g., \"Archiv Agency\" and tagline)."
      ],
      "file_operations": [
        {
          "path": "frontend/vite.config.ts",
          "operation": "modify",
          "description": "Confirm/standardize that the Vite production build output directory remains `dist` (so the asset canister can serve `frontend/dist` as required), and ensure build settings are compatible with static canister hosting. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/DEPLOYMENT.md",
          "operation": "modify",
          "description": "Update documentation to explicitly reference the repo-root `dfx.json` configuration expectation (backend canister + frontend asset canister serving `frontend/dist`) and the verification step that the deployed homepage reads site info from the backend. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Add a complete frontend/package.json so npm install and npm run build succeed with the existing React/Vite/Tailwind/TanStack/next-themes code",
      "acceptanceCriteria": [
        "`frontend/package.json` exists.",
        "From `frontend/`, `npm install` completes without errors.",
        "From `frontend/`, `npm run build` produces a production build in `frontend/dist` (matching `vite.config.ts` outDir)."
      ],
      "file_operations": [
        {
          "path": "frontend/package.json",
          "operation": "create",
          "description": "Create a full `frontend/package.json` with standard Vite + React scripts (dev/build/preview) and all dependencies required by the existing codebase (React, Vite, Tailwind, TanStack Router, TanStack React Query, next-themes, and ICP SDK packages referenced by the frontend). Use the selected `build-template-react` component as the baseline for scripts/dependencies and ensure compatibility with the selected `core-infrastructure` template. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Ensure the frontend canister build/install flow runs Vite build and packages the built frontend/dist assets for DFX deployment",
      "acceptanceCriteria": [
        "`dfx deploy frontend` (local) results in the frontend canister serving the built assets (HTML/CSS/JS load successfully).",
        "No missing-asset errors occur in the browser console when loading the deployed frontend locally."
      ],
      "file_operations": [
        {
          "path": "frontend/package.json",
          "operation": "modify",
          "description": "Add/confirm a dedicated build script suitable for DFX-driven asset packaging (e.g., a script that reliably produces `frontend/dist` before canister install). Ensure scripts match the repoâ€™s Vite config and are appropriate to be called from the DFX build step. Verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/DEPLOYMENT.md",
          "operation": "modify",
          "description": "Document the frontend build step ordering required for DFX (generate bindings if needed, run `npm run build` to create `frontend/dist`, then deploy/install the frontend asset canister) and include a local verification checklist to confirm assets load without console errors. Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Complete frontend/DEPLOYMENT.md with accurate, copy/paste end-to-end deployment steps for local replica and IC mainnet",
      "acceptanceCriteria": [
        "`frontend/DEPLOYMENT.md` includes complete steps for: local replica deploy + verification, and IC mainnet deploy + verification.",
        "All commands in the doc reference existing files/paths and match the final build/deploy process (e.g., building Vite to `frontend/dist` and deploying the asset canister).",
        "User-facing documentation text is in English."
      ],
      "file_operations": [
        {
          "path": "frontend/DEPLOYMENT.md",
          "operation": "modify",
          "description": "Finish the currently truncated section and provide a complete end-to-end guide in English for (1) local replica: start, deploy, verify backend site info + frontend loads; and (2) IC mainnet: deploy, verify URL, check homepage renders backend-provided site info. Ensure all commands/paths match the final repo structure (including `frontend/package.json`, `frontend/dist`, and the repo-root `dfx.json`). Verify the component's usage instructions before implementing."
        }
      ]
    }
  ]
}